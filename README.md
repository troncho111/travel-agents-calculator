# מחשבון סוכני נסיעות

## סקירת הפרויקט
- **שם**: מחשבון סוכני נסיעות
- **מטרה**: מערכת ניהול מתקדמת לסוכני נסיעות לחישוב תמחורים, מעקב אחר עסקאות ולוח תחרות בין סוכנים
- **תכונות עיקריות**:
  - מחשבון תמחור חכם עם המרת מטבעות בזמן אמת
  - ניהול תמחורים ועסקאות לכל סוכן
  - לוח תחרות דינמי (יומי/שבועי/חודשי)
  - תמיכה ב-5 סוכנים: יהודה, גבריאל, אורי, רן, ארז
  - שיתוף תמחורים בין סוכנים

## כתובות URL
- **פיתוח (Sandbox)**: https://3000-iok7h2j47wltrk2dsd7hh-02b9cc79.sandbox.novita.ai
- **ייצור (Production)**: טרם נפרס
- **GitHub**: https://github.com/troncho111/travel-agents-calculator

## ארכיטקטורת נתונים
### מודלי נתונים:
1. **agents** - טבלת סוכנים (5 סוכנים קבועים)
2. **pricings** - תמחורים שנשמרו (כולל פירוט מרכיבים, תמחור, תשלומים)
3. **deals** - עסקאות שבוצעו (סכום מכירה, רווח, תאריך)
4. **exchange_rates** - קאש שערי המרה

### שירותי אחסון:
- **Cloudflare D1 Database** - בסיס נתונים SQLite מבוזר
- **Local Development** - SQLite מקומי עם `--local` flag
- **API חיצוני** - exchangerate-api.com לשערי המרה בזמן אמת

### זרימת נתונים:
1. הסוכן בוחר מטבע בסיס (EUR/USD/GBP/ILS)
2. מוסיף מרכיבי עלות בכל מטבע
3. המערכת מחשבת עלות כוללת במטבע הבסיס
4. מוסיף אחוז תמחור (19-30%)
5. מחשב מחיר סופי והמרה לשקלים
6. שומר תמחור לצפייה עתידית ושיתוף

## מדריך משתמש
### דף הבית
- רשת כרטיסים של 5 הסוכנים
- ניווט ללוח תחרות ולכל התמחורים

### דף סוכן
1. **מחשבון תמחור חדש**:
   - בחר מטבע בסיס
   - הוסף מרכיבי עלות (טיסה, מלון, כרטיסים וכו')
   - הזן אחוז תמחור (19-30%)
   - המערכת מציגה מחיר סופי באירו ובשקלים
   - חשב תשלומים (1-24) עם ריבית (3%/7%)
   - שמור תמחור לעתיד

2. **רשום עסקה**:
   - הזן סכום מכירה ורווח
   - בחר מטבע לכל אחד
   - הזן תאריך עסקה
   - העסקה נשמרת ללוח התחרות

3. **התמחורים שלי**:
   - צפייה בכל התמחורים השמורים
   - עריכה ומחיקה של תמחורים
   - פירוט מלא של כל מרכיב

4. **העסקאות שלי**:
   - רשימת כל העסקאות
   - עריכה ומחיקה
   - סיכום מכירות ורווחים

### לוח תחרות
- סינון לפי יום/שבוע/חודש
- דירוג סוכנים לפי סכום מכירות
- תצוגת רווחים ומספר עסקאות
- מדליות לשלושת הראשונים

### כל התמחורים (משותף)
- צפייה בכל התמחורים של כל הסוכנים
- שכפול תמחורים לסוכן אחר
- עריכה ומחיקה

## תכונות מיוחדות
- **המרת מטבעות בזמן אמת** - עדכון אוטומטי מ-API חיצוני
- **חישוב תשלומים חכם** - כולל ריבית 3% ל-3-5 תשלומים, 7% ל-6+ תשלומים
- **שער המחאות בנק ישראל** - שער אירו + 0.04 פרמיה
- **ממשק רספונסיבי** - תמיכה מלאה בנייד ומחשב
- **עיצוב מתקדם** - Tailwind CSS עם Font Awesome
- **תמיכה בעברית** - RTL מלא וכל הטקסטים בעברית

## פריסה (Deployment)
### פלטפורמה
- **Cloudflare Pages** - פריסת edge עולמית
- **סטטוס**: 🟢 פעיל בסביבת פיתוח
- **טכנולוגיות**:
  - Backend: Hono Framework + TypeScript
  - Frontend: HTML + Tailwind CSS + Vanilla JavaScript
  - Database: Cloudflare D1 (SQLite)
  - Package Manager: npm

### הפעלה מקומית
```bash
# התקנת תלויות
npm install

# יצירת בסיס נתונים מקומי
npm run db:migrate:local

# בנייה
npm run build

# הפעלה עם PM2
pm2 start ecosystem.config.cjs

# בדיקת סטטוס
pm2 status

# צפייה בלוגים
pm2 logs webapp --nostream
```

### פריסה לייצור
```bash
# יצירת בסיס נתונים בענן
npx wrangler d1 create webapp-production
# העתק את database_id לקובץ wrangler.jsonc

# הפעלת מיגרציות
npm run db:migrate:prod

# פריסה
npm run deploy:prod
```

## עדכון אחרון
- **תאריך**: 20 ינואר 2026
- **גרסה**: 1.0.0
- **סטטוס**: מוכן לשימוש בפיתוח ✅
